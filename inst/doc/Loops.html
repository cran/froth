<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Loops</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>







<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Loops</h1>



<p>Computers are excellent are performing the same task over and over
and over again. In order to ensure that it’s just the computer doing
repetitive tasks (and not also the coder typing them out), most
languages employ a type of operation called a loop. Loops come in two
main flavors: definite and indefinite.</p>
<div id="definite-loops" class="section level2">
<h2>Definite loops</h2>
<p>Definite loops are ones in which you specify exactly how many times a
certain process should happen. Just like in Forth, you specify these
loops with <code>DO...LOOP</code>. Let’s look at an example:</p>
<pre><code>fr&gt; 5 0 DO .&quot; Hello!&quot; CR LOOP
Hello!
Hello!
Hello!
Hello!
Hello! 
ok.</code></pre>
<p>These types of loops have five main components:
<code>END START DO xxx LOOP</code>. <code>END</code> and
<code>START</code> specify the ending and starting values for our loop
counter. Think of it like counting: we start at <code>START</code> and
begin counting up to <code>END</code>. For every number we count, we do
the stuff between <code>DO</code> and <code>LOOP</code>.</p>
<p>In this case, we’ve defined a loop with <code>5 0 DO ... LOOP</code>.
This means that we’ll start at 0 and count up to 5. At each value (0, 1,
2, 3, 4), we do the middle stuff, which in this case is printing
<code>Hello!</code>. Note that we stop at <code>END</code> without doing
the stuff again.</p>
<p>It’s often useful to be able to do stuff with the number we’re
currently at. For instance, what if we wanted to print out what number
we’re currently counting at before saying <code>Hello!</code>? In this
case, we use the special word <code>I</code>, which copies the current
value of the loop counter to the stack.</p>
<pre><code>fr&gt; 5 0 DO I . .&quot; Hello!&quot; CR LOOP
0 Hello! 
1 Hello! 
2 Hello! 
3 Hello! 
4 Hello! 
ok.</code></pre>
<p>The <code>LOOP</code> command tells <code>froth</code> to add 1 to
the loop counter. This means that you can use negative numbers and/or
fractions as loop limits:</p>
<pre><code>fr&gt; 0 -2 DO .&quot; looping!&quot; LOOP
looping! looping! ok.
fr&gt; 3.5 0.5 DO .&quot; fraction!&quot; LOOP
fraction! fraction! fraction! ok.</code></pre>
<p>Like with the examples in Chapter 1, you can make words that expect
to find elements on the stack as input to a loop:</p>
<pre><code>fr&gt; : MULTIPLICATION ( n -- ) cr 11 1 do dup i * . loop drop ;
ok.
fr&gt; 7 multiplication
7 14 21 28 35 42 49 56 63 70 ok.</code></pre>
</div>
<div id="more-complex-loops" class="section level2">
<h2>More Complex Loops</h2>
<p><code>if...then</code> statements can be nested within loops to make
the computer do certain operations on certain loop iterations. For
example:</p>
<pre><code>fr&gt; 64 0 do i 8 mod 0= if cr then .&quot; *&quot; loop
* * * * * * * * 
* * * * * * * * 
* * * * * * * * 
* * * * * * * * 
* * * * * * * * 
* * * * * * * * 
* * * * * * * * 
* * * * * * * * ok.</code></pre>
<p>This loop proceeds from 0 to 64. If the loop counter is equivalent to
a multiple of 8 (<code>i 8 mod 0= if</code>), then it prints a newline.
Either way, it prints a star.</p>
<p>Just like with <code>if...then</code> statements, we can also nest
loops. For example:</p>
<pre><code>fr&gt; : multip ( n -- ) cr 5 1 do dup i * . loop drop ;
ok.
fr&gt; : table ( -- ) cr 5 1 do i multip loop ;
1 2 3 4 
2 4 6 8 
3 6 9 12 
4 8 12 16 ok.</code></pre>
<p>This produces a (small) multiplication table. If you change the loop
limits, you can change how big the table is.</p>
<p>The built-in words <code>I</code> copies the current loop counter to
the stack. If you wanted to had nested loops and wanted to access the
outer loop counter from an inner loop, <code>J</code> copies that value
to the stack. <code>K</code> performs a similar operation, but returns
the loop counter two levels up. For example:</p>
<pre><code>fr&gt; 2 0 DO 2 0 DO 2 0 DO I J K . . . CR LOOP LOOP LOOP
0 0 0 
0 0 1 
0 1 0 
0 1 1 
1 0 0 
1 0 1 
1 1 0 
1 1 1 
ok.</code></pre>
<p>We have three nested loops. The outermost one executes twice,
counting from 0 to 2. The middle loop executes twice <em>per outer
loop</em>, counting from 2 to 4 each time. The inner loop executes twice
per middle loop, counting from 4 to 6 each time. In all, the outer loop
runs twice, the middle loop 4 times, and the inner loop 8 times. From
the innermost loop, we use <code>I</code> to get the loop counter,
<code>J</code> to get the second loop counter, and <code>K</code> to get
the outermost loop counter.</p>
<p>We also don’t have to always increment the loop value by 1. Instead,
we can use the <code>+LOOP</code> word, which expects a value on the
stack and increments the loop counter by that amount. For example, we
can modify our previous triple loop:</p>
<pre><code>fr&gt; 10 0 DO 4 0 DO 0 2 DO I J K . . . CR -1 +LOOP 2 +LOOP 5 +LOOP
0 0 2 
0 0 1 
0 0 0 
0 2 2 
0 2 1 
0 2 0 
5 0 2 
5 0 1 
5 0 0 
5 2 2 
5 2 1 
5 2 0 
ok.</code></pre>
<p>Now the outermost loop iterates from 0 to 10 by 5
(<code>10 0 DO ... 5 +LOOP</code>), the second loop iterates from 0 to 4
by 2 (<code>4 0 DO ... 2 +LOOP</code>), and the innermost loop iterates
from 2 to 0 by -1 (<code>0 2 DO ... -1 +LOOP</code>).</p>
<p>Do you see what’s changed? There’s one key difference between the
outer two loops and the inner loop of the previous example. The outer
loops iterate as long as they’re <em>less than</em> the end value, but
the inner loop iterates as long as its <em>greater than or equal to</em>
the end value. When you use a loop with a negative <code>+LOOP</code>
value, keep in mind that the loop will iterate an additional time
compared to the positive direction. For example,
<code>5 0 DO ... 1 +LOOP</code> iterates 5 times, whereas
<code>0 5 DO ... -1 +LOOP</code> iterates 6 times.</p>
</div>
<div id="indefinite-loops" class="section level2">
<h2>Indefinite Loops</h2>
<p>Indefinite loops keep going without a specified end point. These
loops use <code>BEGIN...UNTIL</code> rather than <code>DO...LOOP</code>.
The basic syntax is the same, except that <code>UNTIL</code> will check
the stack for <code>TRUE</code>. If it finds <code>TRUE</code>, the loop
terminates, and otherwise execution jumps back to
<code>BEGIN</code>.</p>
<pre><code>fr&gt; 0 BEGIN 1 + dup dup . 10 &gt; UNTIL
1 2 3 4 5 6 7 8 9 10 11 ok.</code></pre>
<p>Here we start with 0, then at each iteration of the loop we add 1 to
it. We then duplicate it twice, print one of the copies, and then let
<code>UNTIL</code> check if the second copy is greater than 10. Once the
value becomes 11, <code>10 &gt;</code> evaluates to <code>TRUE</code>
and the loop exits.</p>
<p><code>UNTIL</code> checks the condition at the end of the loop, but
what if we wanted to check at the beginning? <code>BEGIN...UNTIL</code>
loops will always execute at least once, but sometimes it’s preferable
to have a loop that doesn’t always execute.</p>
<p>For this, we have <code>BEGIN...WHILE...REPEAT</code> loops.
<code>WHILE</code> examines the stack similar to <code>UNTIL</code>, and
skips immediately to <code>REPEAT</code> if the condition is
<code>TRUE</code>.</p>
<p>Let’s try the previous example again, using a <code>WHILE</code> loop
instead:</p>
<pre><code>fr&gt; 0 BEGIN dup 10 &lt; WHILE dup . 1 +  REPEAT
0 1 2 3 4 5 6 7 8 9 ok.</code></pre>
<p>There are a few differences here. First, we’ve had to reverse the
comparison sign. This is because this loop continues <em>while</em> the
condition is true, whereas <code>BEGIN...UNTIL</code> goes
<em>until</em> the loop is true.</p>
<p>In some particular cases, you need a loop that never ends. The
<code>BEGIN...AGAIN</code> loop will run forever without terminating.
I’d include an example, but it would never stop running…</p>
<p>So in the absence of that, I’ll showcase use of
<code>BEGIN...AGAIN</code> alongside another operator,
<code>LEAVE</code>. <code>LEAVE</code> exits the current loop
immediately. For example:</p>
<pre><code>fr&gt; 0 begin 1 + dup dup . 10 &gt; if leave then again
1 2 3 4 5 6 7 8 9 10 11 ok.</code></pre>
<p>Normally the <code>BEGIN...AGAIN</code> loop would go on forever.
However, in the middle we’re doing <code>10 &gt; if leave then</code>.
This compares the current value on the stack to 10, and if it’s greater
than 10, we run <code>leave</code>. As soon as the value on the stack
reaches 11, we execute <code>leave</code> and the loop finishes.</p>
</div>
<div id="words-in-this-chapter" class="section level2">
<h2>Words in this chapter</h2>
<ul>
<li><code>DO ( end start -- )</code>: starts a definite loop from
<code>start</code> to <code>end</code></li>
<li><code>LOOP ( -- )</code>: increments the loop counter by 1</li>
<li><code>+LOOP ( n -- )</code>: increments the loop counter by n</li>
<li><code>I ( -- n )</code>: copies the current loop counter to the
stack</li>
<li><code>J ( -- n )</code>: copies the enclosing loop’s counter to the
stack</li>
<li><code>K ( -- n )</code>: copies the enclosing loop’s enclosing
loop’s counter to the stack</li>
<li><code>BEGIN ( -- )</code>: starts an indefinite loop</li>
<li><code>AGAIN ( -- )</code>: returns to <code>BEGIN</code></li>
<li><code>WHILE ( flag -- )</code>: if <code>flag</code>, continue; else
jump to after <code>REPEAT</code></li>
<li><code>REPEAT ( -- )</code>: returns to <code>BEGIN</code> following
<code>WHILE</code></li>
<li><code>LEAVE ( -- )</code>: leave the current loop immediately</li>
</ul>
<div class="center">
<ul class="pagination pagination-lg">
<li class="page-item">
<a class="page-link" href="https://www.ahl27.com/froth/articles/Conditionals.html">«</a>
</li>
<li class="page-item">
<a class="page-link" href="https://www.ahl27.com/froth/articles/FundamentalFroth.html">1</a>
</li>
<li class="page-item">
<a class="page-link" href="https://www.ahl27.com/froth/articles/ArithmeticAndStacks.html">2</a>
</li>
<li class="page-item">
<a class="page-link" href="https://www.ahl27.com/froth/articles/Conditionals.html">3</a>
</li>
<li class="page-item active">
<a class="page-link" href="https://www.ahl27.com/froth/articles/Loops.html">4</a>
</li>
<li class="page-item">
<a class="page-link" href="https://www.ahl27.com/froth/articles/Variables.html">5</a>
</li>
<li class="page-item">
<a class="page-link" href="https://www.ahl27.com/froth/articles/RInterface.html">6</a>
</li>
<li class="page-item">
<a class="page-link" href="https://www.ahl27.com/froth/articles/Glossary.html">7</a>
</li>
<li class="page-item">
<a class="page-link" href="https://www.ahl27.com/froth/articles/Variables.html">»</a>
</li>
</ul>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
